<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìº ë²„ ì˜ìƒ ì„¤ëª…ì„œ</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Chiron+GoRound+TC:wght@500&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Chiron GoRound TC', sans-serif;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    background: #2c2c2c; /* ê³µí†µ ë°°ê²½ */
    color: #f0f0f0; /* ê³µí†µ í…ìŠ¤íŠ¸ */
  }
  .container {
    background: #3a3a3a; /* ì»¨í…Œì´ë„ˆ ê³µí†µìƒ‰ */
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.4);
    width: 100%;
    max-width: 500px;
    border: 1px solid #555;
    text-align: center;
  }
  .logo {
    max-width: 180px;
    margin: 0 auto 20px;
    display: block;
  }
  h2 { 
    margin-bottom: 20px; 
    color: #f0f0f0; 
    font-size: 1.8em; /* í°íŠ¸ í¬ê¸° ìˆ˜ì • */
  }

  /* ë“œë¡­ë‹¤ìš´ & ê²€ìƒ‰ì°½ */
  .text-description {
    font-size: 15px;
    margin-bottom: 5px;
    text-align: left;
    color: #bbb;
    padding-left: 5%;
  }
  select, input {
    width: 90%;
    padding: 14px;
    font-size: 16px;
    border-radius: 10px;
    border: 1px solid #777;
    margin: 0 auto 15px;
    display: block;
    box-sizing: border-box;
    background: #2c2c2c;
    color: #f0f0f0;
  }
  #searchBox { width: 85%; }
  
  /* ê²€ìƒ‰ì°½ í…ìŠ¤íŠ¸ ì„¤ëª… */
  #search-text {
    text-align: left;
    margin-top: 10px;
    margin-bottom: 5px;
    color: #bbb;
    font-size: 15px;
    padding-left: 5%;
  }
  #search-info-text {
    text-align: left;
    margin-top: -10px;
    margin-bottom: 15px;
    color: #bbb;
    font-size: 13px;
    padding-left: 5%;
  }

  /* ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ */
  .hidden {
    display: none;
  }
  
  /* 2ë‹¨ê³„ í•˜ë‹¨ í…ìŠ¤íŠ¸ ë§ˆì§„ ì¶”ê°€ */
  #step2-info-text {
    margin-bottom: 20px;
  }

  /* êµ¬ë¶„ì„  */
  hr.divider {
    border: 0;
    height: 1px;
    background: #555;
    margin: 25px auto;
    width: 90%;
  }

  /* ê²€ìƒ‰ ê²°ê³¼ */
  .results { text-align: left; margin-top: 10px; }
  .result-item {
    display: block;
    padding: 10px 14px;
    margin-bottom: 8px;
    border: 1px solid #555;
    border-radius: 8px;
    background: #2c2c2c;
    cursor: pointer;
    text-decoration: none;
    color: #4dabf7; /* ë°ì€í•˜ëŠ˜ */
    font-weight: 500;
  }
  .result-item:hover { background: #444; }

  /* ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ */
  .preview-card {
    margin-top: 20px;
    padding: 15px;
    border: 1px solid #555;
    border-radius: 12px;
    background: #2c2c2c;
    text-align: left;
    color: #f0f0f0;
  }
  .preview-card h3 { margin: 0 0 10px; font-size: 18px; }
  .preview-card a { color: #0071e3; font-weight: 500; }

  /* ì¹´ì¹´ì˜¤í†¡ ë¬¸ì˜ ë²„íŠ¼ */
  .contact-btn {
    display: flex; /* ì´ë¯¸ì§€ë¥¼ í…ìŠ¤íŠ¸ì™€ ë‚˜ë€íˆ ë°°ì¹˜ */
    justify-content: center; /* ë²„íŠ¼ ë‚´ìš© ê°€ìš´ë° ì •ë ¬ */
    align-items: center; /* ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì§ ì¤‘ì•™ì— ë§ì¶¤ */
    margin-top: 20px;
    padding: 12px;
    background: #ffeb00;
    border-radius: 8px;
    font-weight: bold;
    color: #000;
    text-decoration: none;
  }
  /* ìƒˆë¡œìš´ ì´ë¯¸ì§€ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
  .contact-icon {
    width: 24px;
    height: 24px;
    margin-right: 8px;
  }

  /* ê²€ìƒ‰ í•˜ì´ë¼ì´íŠ¸ */
  mark { background: yellow; color: black; }
</style>
</head>
<body>
  <div class="container">
    <img src="https://i.imgur.com/10We0IH.png" alt="ìº ë²„ ë¡œê³ " class="logo">
    <h2>ìº í•‘ì¹´ ì‚¬ìš© ì•ˆë‚´ ë™ì˜ìƒ</h2>

    <div class="text-description">1. íšŒì‚¬ ì„ íƒ</div>
    <select id="level1-select">
      <option value="" selected disabled>ğŸ¢ íšŒì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
    </select>

    <div id="step2-text" class="text-description hidden">2. ê¸°ëŠ¥ ì„ íƒ</div>
    <select id="level2-select" class="hidden">
      <option value="" selected disabled>âš™ï¸ ê¸°ëŠ¥ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>
    </select>
    <div id="step2-info-text" class="text-description hidden">ì£¼ìš”ê¸°ëŠ¥ : ë¬´ì‹œë™ ì—ì–´ì»¨, íˆí„°, ì–´ë‹, í‰íƒ„í™”, íŒì—…í…íŠ¸<br>ë¶€ê°€ê¸°ëŠ¥ : ì™¸ë¶€ì „ì›ì¶©ì „ê¸°, ì™¸ë¶€ìƒ¤ì›Œê¸°, ì²­ìˆ˜ ì˜¤ìˆ˜, ì¡°ëª…, ëƒ‰ì¥ê³ , ì‹±í¬ëŒ€, TV</div>

    <div id="step3-text" class="text-description hidden">3. ì˜ìƒ ì„ íƒ</div>
    <select id="level3-select" class="hidden">
      <option value="" selected disabled>ğŸ¬ ì˜ìƒì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>
    </select>

    <hr class="divider">

    <div id="search-text">â€»ê²€ìƒ‰ ê¸°ëŠ¥â€»</div>
    <input type="text" id="searchBox" placeholder="ğŸ” ì˜ìƒì„ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”">
    <div id="search-info-text">í•„ìš”í•˜ì‹  ê¸°ëŠ¥ í•œë²ˆì— ê²€ìƒ‰í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ê²€ìƒ‰ë’¤ ì´ìš©í•˜ì‹œëŠ” íšŒì‚¬ ì°¨ëŸ‰ì— ë§ì¶°ì„œ ì„¤ëª…ì„œ ëˆŒëŸ¬ì£¼ì‹œë©´ ì„¤ëª…ë™ì˜ìƒì´ ìƒˆì°½ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤.</div>

    <div class="results" id="results"></div>

    <div class="preview-card" id="preview" style="display:none;"></div>

    <a href="http://pf.kakao.com/_njISxb/chat" target="_blank" class="contact-btn">
      <img src="https://i.imgur.com/u4T0qDa.png" alt="ì¹´ì¹´ì˜¤í†¡ ë¬¸ì˜ ì•„ì´ì½˜" class="contact-icon">
      ì¹´ì¹´ì˜¤í†¡ ë¬¸ì˜í•˜ê¸°
    </a>
  </div>

<script>
const excelData = [
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ë¬´ì‹œë™ ì—ì–´ì»¨ ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=139&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ë¬´ì‹œë™ íˆí„° ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=138&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ì‹¤ë‚´ ì¢Œì„ í‰íƒ„í™”", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=133&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ì–´ë‹í…íŠ¸ ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=134&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì „ìì œí’ˆ ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=135&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì „ì²´ ì‚¬ìš©ë²• ì˜ìƒ", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=130&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "íŒì—…í…íŠ¸ ë‹«ê¸°", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=132&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "íŒì—…í…íŠ¸ ì—´ê¸°", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=131&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "TV ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=137&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ ì—”ì§€ë‹ˆì–´ë§", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì‹±í¬ëŒ€ ì‚¬ìš©ë²•", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=136&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24mYl9jYXRlZ29yeT3tmITrjIDsl5Tsp4Dri4jslrTrp4E=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ë¬´ì‹œë™ ì—ì–´ì»¨", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=114&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ë¬´ì‹œë™ íˆí„°", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=115&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ì–´ë‹í…íŠ¸ ì„¤ì¹˜", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=118&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ì–´ë‹í…íŠ¸ ì² ìˆ˜", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=119&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "ì¢Œì„ í‰íƒ„í™”", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=125&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "íŒì—… ì»¨íŠ¸ë¡¤ëŸ¬", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=127&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "íŒì—…í…íŠ¸ ì„¤ì¹˜", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=128&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "íŒì—…í…íŠ¸ ì² ìˆ˜", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=129&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ì£¼ìš”ê¸°ëŠ¥", step3: "íŠ¸ë í¬ í…Œì´ë¸”", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=126&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì™¸ë¶€ ì „ì› ì¶©ì „ê¸° ì¶©ì „", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=122&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì™¸ë¶€ìƒ¤ì›Œê¸°", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=124&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì²­ìˆ˜ ë³´ì¶©", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=120&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì˜¤ìˆ˜ ë°°ì¶œ", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=121&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì¡°ëª…", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=123&_PVSC=JnBuPWJvYXJkLmxpc3QmX21lbnU9Y2FtcGluZ2Nhcl9ub3Rpb24=" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "2ì—´ ì‹¤ë‚´ í…Œì´ë¸”", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=112" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ëƒ‰ì¥ê³ ", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=113" },
  { step1: "í˜„ëŒ€ìë™ì°¨", step2: "ë¶€ê°€ê¸°ëŠ¥", step3: "ì‹±í¬ëŒ€", url: "https://www.vanpick.co.kr/?pn=board.view&_menu=campingcar_notion&_uid=117" }
];
  const level1 = document.getElementById("level1-select");
  const level2 = document.getElementById("level2-select");
  const level3 = document.getElementById("level3-select");
  const searchBox = document.getElementById("searchBox");
  const resultsDiv = document.getElementById("results");
  const preview = document.getElementById("preview");

  // í…ìŠ¤íŠ¸ ì„¤ëª… ìš”ì†Œ
  const step2Text = document.getElementById("step2-text");
  const step3Text = document.getElementById("step3-text");
  const step2InfoText = document.getElementById("step2-info-text");

  // 1ë‹¨ê³„ íšŒì‚¬ ëª©ë¡
  [...new Set(excelData.map(i => i.step1))].forEach(val => {
    const opt = document.createElement("option");
    opt.value = val;
    opt.textContent = val;
    level1.appendChild(opt);
  });

  // íšŒì‚¬ ì„ íƒ â†’ ê¸°ëŠ¥ ëª©ë¡
  level1.addEventListener("change", function() {
    const company = this.value;
    level2.innerHTML = '<option value="" selected disabled>âš™ï¸ ê¸°ëŠ¥ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>';
    level3.innerHTML = '<option value="" selected disabled>ğŸ¬ ì˜ìƒì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>';

    // 2ë‹¨ê³„ì™€ 3ë‹¨ê³„ ë©”ë‰´ ë° í…ìŠ¤íŠ¸ ìˆ¨ê¹€
    level2.classList.add("hidden");
    level3.classList.add("hidden");
    step2Text.classList.add("hidden");
    step3Text.classList.add("hidden");
    step2InfoText.classList.add("hidden");

    const step2Values = [...new Set(excelData.filter(i => i.step1 === company).map(i => i.step2))];
    step2Values.forEach(val => {
      const opt = document.createElement("option");
      opt.value = val;
      opt.textContent = val;
      level2.appendChild(opt);
    });
    
    // 2ë‹¨ê³„ ë©”ë‰´ì™€ í…ìŠ¤íŠ¸ ë³´ì´ê²Œ í•¨
    level2.classList.remove("hidden");
    step2Text.classList.remove("hidden");
    step2InfoText.classList.remove("hidden");
  });

  // ê¸°ëŠ¥ ì„ íƒ â†’ ì˜ìƒ ëª©ë¡
  level2.addEventListener("change", function() {
    const company = level1.value;
    const func = this.value;
    level3.innerHTML = '<option value="" selected disabled>ğŸ¬ ì˜ìƒì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>';
    
    // 3ë‹¨ê³„ ë©”ë‰´ì™€ í…ìŠ¤íŠ¸ ìˆ¨ê¹€
    level3.classList.add("hidden");
    step3Text.classList.add("hidden");

    const step3Items = excelData.filter(i => i.step1 === company && i.step2 === func);
    step3Items.forEach(item => {
      const opt = document.createElement("option");
      opt.value = item.url;
      opt.textContent = item.step3;
      level3.appendChild(opt);
    });
    
    // 3ë‹¨ê³„ ë©”ë‰´ì™€ í…ìŠ¤íŠ¸ ë³´ì´ê²Œ í•¨
    level3.classList.remove("hidden");
    step3Text.classList.remove("hidden");
  });

  // ì˜ìƒ ì„ íƒ
  level3.addEventListener("change", function() {
    const url = this.value;
    const text = this.options[this.selectedIndex].textContent;
    if (url) {
      window.open(url, "_blank");
      showPreview({ step3: text, step1: level1.value, url: url });
    }
  });

  // ê²€ìƒ‰ (ì „ì²´ ëŒ€ìƒ)
  searchBox.addEventListener("input", function() {
    const query = this.value.toLowerCase();
    resultsDiv.innerHTML = "";
    preview.style.display = "none";
    if (!query) return;

    const filtered = excelData.filter(i => i.step3.toLowerCase().includes(query));

    filtered.forEach(item => {
      const highlighted = item.step3.replace(
        new RegExp(query, "gi"),
        match => `<mark>${match}</mark>`
      );

      const a = document.createElement("a");
      a.innerHTML = `[${item.step1}] ${highlighted}`;
      a.href = item.url;
      a.target = "_blank";
      a.className = "result-item";
      a.onclick = () => showPreview(item);
      resultsDiv.appendChild(a);
    });
  });

  // ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ
  function showPreview(item) {
    preview.innerHTML = `
      <h3>ğŸ¬ ${item.step3}</h3>
      <p><strong>íšŒì‚¬:</strong> ${item.step1}</p>
      <a href="${item.url}" target="_blank">ğŸ‘‰ ìƒˆì°½ì—ì„œ ë³´ê¸°</a>
    `;
    preview.style.display = "block";
  }
</script>
</body>
</html>
